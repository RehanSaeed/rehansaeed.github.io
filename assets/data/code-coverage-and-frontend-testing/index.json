{"hash":"4e275c43f423f106133b37ed91e8ff267e789802","data":{"post":{"title":"Code Coverage & Frontend Testing","path":"/code-coverage-and-frontend-testing/","date":"2021-05-10T11:23:00+00:00","dateModified":null,"timeToRead":2,"author":"Muhammad Rehan Saeed","headings":[{"value":"Jest"},{"value":"Cypress"}],"tags":[{"id":"Unit Testing","title":"Unit Testing","path":"/tag/unit-testing/"},{"id":"Integration Testing","title":"Integration Testing","path":"/tag/integration-testing/"},{"id":"Code Coverage","title":"Code Coverage","path":"/tag/code-coverage/"},{"id":"Jest","title":"Jest","path":"/tag/jest/"},{"id":"Cypress","title":"Cypress","path":"/tag/cypress/"}],"description":"What is the correct level of code coverage for your project and what tools are best for quickly writing unit and integration tests for a frontend application.","content":"<p>I was recently asked an interesting question about unit test code coverage and frontend testing by a colleague:</p>\n<blockquote>\n<p>Policies describe 80% plus unit test coverage and our React devs are pushing back a lot, arguing there is little logic in React and it would be a wast of time.\nRehan any advice/pointer for us on this?</p>\n</blockquote>\n<p>Code coverage in tests is always a controversial topic with developers in which I don't think there is a 'correct' answer. The answer you're going to get from most people is 'it depends' ü§∑üèº.</p>\n<p>If you're developing a mars rover where one bad line of code could mean mission over or flight navigation software, go ahead and go for 100% code coverage, let alone 80%. The question is, how tolerant are you to the risk of a bug in the front end React code? If something doesn't work, how long will it take you to fix it and how much will that cost you versus the cost of writing extra tests?</p>\n<h1 id=\"jest\"><a href=\"#jest\" aria-hidden=\"true\"><svg xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"22\" height=\"22\" aria-hidden=\"true\"><path fill=\"currentColor\" fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Jest</h1>\n<p>Specifically regarding frontend unit testing, my team has been using <a href=\"https://jestjs.io/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Jest</a> which is an excellent unit testing framework built by Facebook which I highly recommend. Jest is special because it's a single NPM package with everything you need rolled into it, including an assertion library, mocking framework and code coverage tools.</p>\n<p>To reduce the burden of writing tests you can leverage snapshot testing. A snapshot test takes very few lines of code to write and generates a file containing the rendered HTML for a Vue/React/Angular/Web/Other component. My team writes at least one snapshot test for every component we write and it hasn't been too onerous for us.</p>\n<p>I just ran the code coverage tool built into Jest on one of our projects and it came to 78.7% coverage. It's worth mentioning that our projects are mostly very simple and don't contain much complex branching logic. Jest also allows you to set a code coverage limit which will fail a build if code coverage drops below a certain level set by you. Here is an example of configuring Jest that in your <code class=\"language-inline-text\">package.json</code> file to do just that:</p>\n<div class=\"line-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token property\">\"jest\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token property\">\"coverageThreshold\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"global\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token property\">\"branches\"</span><span class=\"token operator\">:</span> <span class=\"token number\">70</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"functions\"</span><span class=\"token operator\">:</span> <span class=\"token number\">70</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"lines\"</span><span class=\"token operator\">:</span> <span class=\"token number\">70</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"statements\"</span><span class=\"token operator\">:</span> <span class=\"token number\">-10</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h1 id=\"cypress\"><a href=\"#cypress\" aria-hidden=\"true\"><svg xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"22\" height=\"22\" aria-hidden=\"true\"><path fill=\"currentColor\" fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Cypress</h1>\n<p>In addition, if you want a robust system, it's also worth setting up some integration or functional tests. I recommend a tool called <a href=\"https://www.cypress.io/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Cypress</a> for this job. According to the testing pyramid you need fewer of these tests as compared to unit tests as they can be more brittle.</p>\n<p><img class=\"g-image g-image--lazy g-image--loading\" src=\"data:image/svg+xml,%3csvg fill='none' viewBox='0 0 800 400' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3cdefs%3e%3cfilter id='__svg-blur-ef10165b10c1c5d26094f643c479c1fc'%3e%3cfeGaussianBlur in='SourceGraphic' stdDeviation='40'/%3e%3c/filter%3e%3c/defs%3e%3cimage x='0' y='0' filter='url(%23__svg-blur-ef10165b10c1c5d26094f643c479c1fc)' width='800' height='400' xlink:href='data:image/png%3bbase64%2ciVBORw0KGgoAAAANSUhEUgAAAEAAAAAgCAIAAAAt/%2bnTAAAACXBIWXMAAA7DAAAOwwHHb6hkAAADIklEQVRYw%2b2Y2XIpURSGvf9DcOUJuDJGIYRS5inGEEGZHY4hIecrq9LVR9KdlgjOKeuia/e2e%2b/1r/WvYTO9/uNiugK4AjgXgO12u9lsDK40ssbIsu8C2L7JQZ8chOHQ/U1fsz3P8XjsdDo/VW46nd7f3%2bssEzfe3d2VSiXl9UcAvLy81Ov1arVaq9UYz2Yzj8ejo5nMF4vFWCzW6/W0VorG8Xg8kUhUKpV8Pp9OpweDgUG/GQWw2QlKs/VoNHp%2bfuaV87SOkclOpyNrkskkn%2bjgbLVa7LxYLH7tBAMd2QMckM1msRMKYSFYUS6XsZaOnVarVSqVEr2fnp5w3YeLZQbfDodDg1Y/GACbrtdrFGq325jn906wFvTQ0QlO9/v9brcL01gM2slk8n79HgAc%2b%2bNBrIREoVDQUghdxT/Y3uVy4Yf5fJ7JZLQo9LMe%2bDCjawEQgfRYHQpFo1HIc3t7S/w8PDw0m829T04K4FMPyBirPz4%2bMoA/brc7GAyScAloZnALbDybB4xQiFBBXQKAKCfhNhqN%2bk6IfjwQiUTIBOqvLgiAkvjJ%2bpB%2boRKsvlwuGbAml8up0/ylAJAnaQcAKIofwCC5i8SCcjIpGYxEfHEAZIbYRV2Hw2E2m0k%2bNpvNarX6/X6YY7FY7HY7rwQD6Rh2qXu4MwOQU6E74ctACjYmx9gMKB2gmuyEKg6XJJr5VWklzu8BlCZjopNUOrQn8cuAJ78q8SBjSjvuuiAA0JroxAlVlZB5pPmrvIm88qQg0IESM7LbiQDgfQIR%2b2E2BQACp0ma%2bo2dVrMkZeEUANgas2FjDCldjTQLIMH8SnkSDaAH9cvr9QYCgVAoREDTEfl8Pq4H6rAhZgQ5blEDMA7jAACcTURibPzOYTBbzuYpsSt9mHCaQkbnQ83iyVeERzgchjNcg/ZWsgDHUrOFaWRhCHZ8AGJ%2bDqCRFhJTrciPRKpWT2qws8KZVGhuM7iRMdYhU53iSskxNzc3cBczA0l6B0XktfROyn8LMxgFJ8AxnevR8bOQun1Yfk%2bk0VAHxonuA1%2bjzZn/Vrn%2bM3cF8P8B%2bANMa3QGX1G6BAAAAABJRU5ErkJggg==' /%3e%3c/svg%3e\" width=\"800\" alt=\"Testing Pyramid showing UI, Service and Unit Tests in that order\" data-srcset=\"/assets/static/Test-Pyramid-800x400.82a2fbd.4079bc7448f938fc9d541181eade8b52.png 480w, /assets/static/Test-Pyramid-800x400.775f9c8.4079bc7448f938fc9d541181eade8b52.png 800w\" data-sizes=\"(max-width: 800px) 100vw, 800px\" data-src=\"/assets/static/Test-Pyramid-800x400.775f9c8.4079bc7448f938fc9d541181eade8b52.png\"><noscript><img class=\"g-image g-image--lazy g-image--loaded\" src=\"/assets/static/Test-Pyramid-800x400.775f9c8.4079bc7448f938fc9d541181eade8b52.png\" width=\"800\" alt=\"Testing Pyramid showing UI, Service and Unit Tests in that order\"></noscript></p>\n<p>I've found them very useful for making sure that you don't release something completely broken (happens more often in the wild than any dev would like you to think). In fact, I use Cypress for this very blog to verify every commit to make sure I don't accidentally break it.</p>\n","heroImage":"/images/hero/Jest-Cypress-1600x900.png"}},"context":{}}