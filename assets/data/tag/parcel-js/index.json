{"hash":"5d70fa80559e891eaacfe65f2a74c67ee8ab85f3","data":{"tag":{"title":"ParcelJS","path":"/tag/parcel-js/","belongsTo":{"edges":[{"node":{"title":"Writing your Webpack configuration in TypeScript","path":"/writing-your-webpack-configuration-in-typescript/","date":"3 January 2018","timeToRead":4,"description":"Learn how to write your Webpack configuration file using TypeScript to get intellisense and how to exclude Webpack 1 syntax from your TypeScript typings.","content":"<h1 id=\"webpack-configuration-is-a-mess\"><a href=\"#webpack-configuration-is-a-mess\" aria-hidden=\"true\"><svg xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"22\" height=\"22\" aria-hidden=\"aria-hidden\"><path fill=\"currentColor\" fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Webpack Configuration is a Mess</h1>\n<div class=\"custom-block warning\"><p class=\"custom-block-title\">Warning</p><p>Before you get the wrong idea, let me say that Webpack is a super powerful, it's what you probably should be using these days to deal with static assets and I like its power...</p></div>\n<p>However, Webpack configuration files are write once software, they are a mess, a complete and utter mess. There, I said it. It has a steep learning curve and plenty of magic. What's worse is that Webpack makes it intentionally harder than it needs to be. If you look online at examples, even in the Webpack docs themselves, you'll see a dozen examples that look completely different, this is for two reasons:</p>\n<ol>\n<li>In its wisdom, Webpack decided it was a good idea to provide lots of different ways to configure it. There are four, yes four different ways to configure a rule and another four to configure a loader.</li>\n<li>When Webpack 2 came out, they significantly changed the configuration syntax. They didn't want to make breaking changes, so they supported Webpack 1 and 2 syntax together.</li>\n</ol>\n<p>What you ended up with is eight ways to configure a rule or loader, which is insane.</p>\n<h1 id=\"parceljs\"><a href=\"#parceljs\" aria-hidden=\"true\"><svg xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"22\" height=\"22\" aria-hidden=\"aria-hidden\"><path fill=\"currentColor\" fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ParcelJS</h1>\n<p>I'm going off on a tangent here but there is a new module bundler in development called <a href=\"https://parceljs.org/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">ParcelJS</a> which has support for JavaScript, HTML, CSS, SASS and images built in from the start with zero configuration! Adding Babel, TypeScript or Autoprefixer is also much easier with no need to configure Parcel to work with them.</p>\n<p>Unfortunately, it's not ready for prime time yet as it is lacking support for source maps, multiple entry points, code splitting and Vue components. I have high hopes for ParcelJS in the future!</p>\n<h1 id=\"why-typescript\"><a href=\"#why-typescript\" aria-hidden=\"true\"><svg xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"22\" height=\"22\" aria-hidden=\"aria-hidden\"><path fill=\"currentColor\" fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Why TypeScript?</h1>\n<p>Happily, as I'll show below TypeScript can help you to completely avoid Webpack 1 syntax. Secondly, if you're already writing your application using TypeScript, then often the only JavaScript files you have left in your project end up being the Webpack configuration files. Converting Webpack configuration to TypeScript removes the need to switch context and switch between languages.</p>\n<h1 id=\"how-is-it-done\"><a href=\"#how-is-it-done\" aria-hidden=\"true\"><svg xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"22\" height=\"22\" aria-hidden=\"aria-hidden\"><path fill=\"currentColor\" fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>How is it done?</h1>\n<p>It turns out that Webpack <a href=\"https://webpack.js.org/configuration/configuration-languages/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">supports</a> the use of TypeScript itself. However, the supported method requires you to add a couple of NPM packages as a dependency and you will not be able to use ES 2015 module syntax in your configuration file because it's not supported.</p>\n<p>In my opinion, a much simpler and cleaner way is to use the TypeScript tsc command line tool to transpile TypeScript to JavaScript before running Webpack. You could add this command as a simple NPM script in your package.json file. Here are the commands you need to use:</p>\n<div class=\"line-highlight\" data-language=\"powershell\"><pre class=\"language-powershell\"><code class=\"language-powershell\">tsc <span class=\"token operator\">--</span>lib es6 webpack<span class=\"token punctuation\">.</span>config<span class=\"token punctuation\">.</span>ts\nwebpack <span class=\"token operator\">--</span>config webpack<span class=\"token punctuation\">.</span>config<span class=\"token punctuation\">.</span>js</code></pre></div>\n<p>Webpack does not come with TypeScript typings, so you'll also need to install the <code class=\"language-text\">@types/webpack</code> NPM package. Finally, to remove all Webpack 1 syntax, you need to create some new types extending the Webpack types, which remove the Webpack 1 syntax, I stuck all of these typings in a <code class=\"language-text\">webpack.common.ts</code> file:</p>\n<div class=\"line-highlight\" data-language=\"ts\"><pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"token keyword\">import</span> <span class=\"token operator\">*</span> <span class=\"token keyword\">as</span> webpack <span class=\"token keyword\">from</span> <span class=\"token string\">\"webpack\"</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// Remove the Old Webpack 1 types to ensure that we are only using Webpack 2 syntax.</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">type</span> INewLoader <span class=\"token operator\">=</span> <span class=\"token builtin\">string</span> <span class=\"token operator\">|</span> webpack<span class=\"token punctuation\">.</span>NewLoader<span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">interface</span> <span class=\"token class-name\">INewLoaderRule</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">webpack<span class=\"token punctuation\">.</span>NewLoaderRule</span> <span class=\"token punctuation\">{</span>\n  loader<span class=\"token operator\">:</span> INewLoader<span class=\"token punctuation\">;</span>\n  oneOf<span class=\"token operator\">?</span><span class=\"token operator\">:</span> INewRule<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n  rules<span class=\"token operator\">?</span><span class=\"token operator\">:</span> INewRule<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">interface</span> <span class=\"token class-name\">INewUseRule</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">webpack<span class=\"token punctuation\">.</span>NewUseRule</span> <span class=\"token punctuation\">{</span>\n  oneOf<span class=\"token operator\">?</span><span class=\"token operator\">:</span> INewRule<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n  rules<span class=\"token operator\">?</span><span class=\"token operator\">:</span> INewRule<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n  use<span class=\"token operator\">:</span> INewLoader <span class=\"token operator\">|</span> INewLoader<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">interface</span> <span class=\"token class-name\">INewRulesRule</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">webpack<span class=\"token punctuation\">.</span>RulesRule</span> <span class=\"token punctuation\">{</span>\n  oneOf<span class=\"token operator\">?</span><span class=\"token operator\">:</span> INewRule<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n  rules<span class=\"token operator\">:</span> INewRule<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">interface</span> <span class=\"token class-name\">INewOneOfRule</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">webpack<span class=\"token punctuation\">.</span>OneOfRule</span> <span class=\"token punctuation\">{</span>\n  oneOf<span class=\"token operator\">:</span> INewRule<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n  rules<span class=\"token operator\">?</span><span class=\"token operator\">:</span> INewRule<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">type</span> INewRule <span class=\"token operator\">=</span> INewLoaderRule <span class=\"token operator\">|</span> INewUseRule <span class=\"token operator\">|</span> INewRulesRule <span class=\"token operator\">|</span> INewOneOfRule<span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">interface</span> <span class=\"token class-name\">INewModule</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">webpack<span class=\"token punctuation\">.</span>NewModule</span> <span class=\"token punctuation\">{</span>\n  rules<span class=\"token operator\">:</span> INewRule<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">interface</span> <span class=\"token class-name\">INewConfiguration</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">webpack<span class=\"token punctuation\">.</span>Configuration</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">module</span><span class=\"token operator\">?</span><span class=\"token operator\">:</span> INewModule<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">interface</span> <span class=\"token class-name\">IArguments</span> <span class=\"token punctuation\">{</span>\n  prod<span class=\"token operator\">:</span> <span class=\"token builtin\">boolean</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">type</span> <span class=\"token function-variable function\">INewConfigurationBuilder</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">env<span class=\"token operator\">:</span> IArguments</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> INewConfiguration<span class=\"token punctuation\">;</span></code></pre></div>\n<p>You can then use these types in your Webpack configuration:</p>\n<div class=\"line-highlight\" data-language=\"ts\"><pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"token keyword\">import</span> <span class=\"token operator\">*</span> <span class=\"token keyword\">as</span> path <span class=\"token keyword\">from</span> <span class=\"token string\">\"path\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token operator\">*</span> <span class=\"token keyword\">as</span> webpack <span class=\"token keyword\">from</span> <span class=\"token string\">\"webpack\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> INewConfiguration <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"./webpack.common\"</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> configuration<span class=\"token operator\">:</span> INewConfiguration <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// ...</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> configuration<span class=\"token punctuation\">;</span></code></pre></div>\n<p>Or you can also pass arguments to your webpack configuration file like so:</p>\n<div class=\"line-highlight\" data-language=\"ts\"><pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"token keyword\">import</span> <span class=\"token operator\">*</span> <span class=\"token keyword\">as</span> path <span class=\"token keyword\">from</span> <span class=\"token string\">\"path\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token operator\">*</span> <span class=\"token keyword\">as</span> webpack <span class=\"token keyword\">from</span> <span class=\"token string\">\"webpack\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> IArguments<span class=\"token punctuation\">,</span> INewConfiguration<span class=\"token punctuation\">,</span> INewConfigurationBuilder <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"./webpack.common\"</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> configurationBuilder<span class=\"token operator\">:</span> INewConfigurationBuilder <span class=\"token operator\">=</span> \n  <span class=\"token punctuation\">(</span>env<span class=\"token operator\">:</span> IArguments<span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> <span class=\"token parameter\">INewConfiguration</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> isDevBuild <span class=\"token operator\">=</span> <span class=\"token operator\">!</span><span class=\"token punctuation\">(</span>env <span class=\"token operator\">&amp;&amp;</span> env<span class=\"token punctuation\">.</span>prod<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">const</span> configuration<span class=\"token operator\">:</span> INewConfiguration <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token comment\">// ...</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">return</span> configuration<span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> configurationBuilder<span class=\"token punctuation\">;</span></code></pre></div>\n<p>In this case, you can pass arguments to the webpack configuration file like so:</p>\n<div class=\"line-highlight\" data-language=\"powershell\"><pre class=\"language-powershell\"><code class=\"language-powershell\">> webpack <span class=\"token operator\">--</span>env<span class=\"token punctuation\">.</span>prod</code></pre></div>\n<h1 id=\"conclusion\"><a href=\"#conclusion\" aria-hidden=\"true\"><svg xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"22\" height=\"22\" aria-hidden=\"aria-hidden\"><path fill=\"currentColor\" fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Conclusion</h1>\n<p>I think most people have huge trouble getting to grips with Webpack, once you understand that there are so many ways to supply the same config and how to translate between them, the learning curve gets shallower. You will be able to translate all of the examples you see online that inevitably are using a different syntax to you, so you can 'borrow' (It's what us software developers do for much of the day) their code and get stuff done.</p>\n"}}]}}},"context":{}}